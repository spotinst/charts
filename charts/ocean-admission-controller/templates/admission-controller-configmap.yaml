{{- if .Values.controller.configMap.create }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "ocean-admission-controller.configMapName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
  {{- include "ocean-admission-controller.controllerLabels" . | nindent 4 }}
data:
  SPOTINST_CONTROLLER_CLUSTER_IDENTIFIER: {{ required "`spotinst.clusterIdentifier` must be specified" .Values.spotinst.clusterIdentifier }}
  SPOTINST_BASE_URL: {{ .Values.spotinst.baseUrl | quote }}
  HTTPS_PROXY: {{ .Values.spotinst.proxyUrl | quote }}
  LEADER_ELECTION: {{ gt (int .Values.controller.replicaCount) 1 | quote }}
  METRICS_ADDR: "{{ .Values.controller.metricsAddr }}"
  HEALTH_PROBE_ADDR: "{{ .Values.controller.healthProbeAddr }}"
  CERT_DIR: {{ .Values.controller.certDir | quote }}
  ENABLE_POD_VOLUME_NODE_AFFINITY_DEFAULTER: {{ .Values.controller.podVolumeNodeAffinityDefaulter.enable | quote }}
  ENABLE_POD_TOLERATION_DEFAULTER: {{ .Values.controller.podTolerationDefaulter.enable | quote }}
{{- end }}
